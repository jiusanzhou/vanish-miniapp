{"version":3,"sources":["apps/debugger.jsx","apps sync /^/.//.*$","utils/serviceWorker.js","utils/global.jsx","pages/app.jsx","pages/home.jsx","pages/404.jsx","App.jsx","stores/appStore.js","stores/index.js","styles/theme.js","index.js","apps/checkin.jsx"],"names":["DebuggerApp","state","res","input","script","document","createElement","src","async","id","body","appendChild","getElementById","remove","e","this","setState","target","value","eval","exception","w","size","onChange","handleInputChange","bind","mt","onClick","handleRunClick","mb","style","wordWrap","JSON","stringify","React","Component","map","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","keys","Object","resolve","module","exports","Boolean","window","location","hostname","match","EventBusContext","createContext","Provider","Consumer","withGlobal","WrappedComponent","GlobalBus","globalData","props","GlobalProvider","homepage","require","data","basePath","URL","pathname","children","AppPage","withRouter","appCaches","app","name","default","title","Text","AppPreview","history","push","icon","Flex","_onClick","cursor","border","borderRadius","borderColor","h","align","justify","direction","Icon","my","HomePage","inject","Box","p","Grid","templateColumns","gap","appStore","apps","idx","key","NotFoundPage","addCount","App","observer","loadApps","exact","path","component","mockApps","isLoading","appsRegistry","clear","forEach","item","set","text","Array","from","values","observable","computed","action","theme","colors","brand","900","800","700","ReactDOM","render","stores","ThemeProvider","navigator","serviceWorker","ready","then","registration","unregister","CheckinApp","date","Date","email","address","longitude","latitude","checkinTime","getTime","checkoutTime","jsVanish","d","getVanishUserInfo","user","parse","ClientName","ClientEmail","device_id","getDeviceUUID","loadTodayInfo","type","checkIn","clock_addr","clock_addr_num","console","log","alert","queryCheckIn","toISOString","split","templateRows","onDateClick","localeUtils","LocaleUtils","locale","CheckinItem","label","checkTime","disable","done","precision","TimePrecision","SECOND","serialize","obj","prefix","str","hasOwnProperty","k","v","encodeURIComponent","join","apiHost","i","String","fromCharCode","request","url","method","fetch","headers","json","status","payload"],"mappings":"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","file":"static/js/main.6ff18430.chunk.js","sourcesContent":["import React from \"react\"\nimport { Box, Button, Text, Code, Textarea } from \"@chakra-ui/core\"\n\nclass DebuggerApp extends React.Component {\n    constructor() {\n        super()\n        this.state = {\n            res: \"\",\n            input: \"\",\n        }\n    }\n\n    componentWillMount() {\n        const script = document.createElement(\"script\")\n        script.src = \"https://cdnjs.cloudflare.com/ajax/libs/firebug-lite/1.4.0/firebug-lite.js\"\n        script.async = true\n        script.id = \"firebug_lite_js\"\n        document.body.appendChild(script)\n    }\n\n    componentWillUnmount() {\n        document.getElementById(\"firebug_lite_js\").remove()\n    }\n\n    handleInputChange(e) {\n        this.setState({input: e.target.value})\n    }\n\n    handleRunClick() {\n        let res\n        try { res = eval(this.state.input) } catch(e) { res = { exception: e } }\n        this.setState({res})\n    }\n\n    render() {\n        return <Box>\n            <Text>调试应用</Text>\n            <Textarea w=\"200px\" size=\"sm\" value={this.state.input} onChange={this.handleInputChange.bind(this)} />\n            <Button mt=\"8px\" onClick={this.handleRunClick.bind(this)}>运行</Button>\n            <Text mb=\"8px\">执行结果：</Text>\n            <Code w=\"100%\" style={{wordWrap:\"break-word\"}}>{this.state.res?JSON.stringify(this.state.res):null}</Code>\n        </Box>\n    }\n}\n\nexport default DebuggerApp","var map = {\n\t\"./checkin\": 97,\n\t\"./checkin.jsx\": 97,\n\t\"./debugger\": 112,\n\t\"./debugger.jsx\": 112\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 178;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\"\nimport PropTypes from 'prop-types'\n\nconst EventBusContext = React.createContext({})\nconst Provider = EventBusContext.Provider\nconst Consumer = EventBusContext.Consumer\n\nexport { Provider }\nexport { Consumer }\n\n// TODO: multi toasts\n\nexport const withGlobal = (WrappedComponent) => {\n    class WithGlobal extends React.Component {\n        render() {\n            return (\n                <Consumer>\n                    {GlobalBus => <WrappedComponent globalData={GlobalBus} {...this.props} />}\n                </Consumer>\n            )\n        }\n    }\n\n    return WithGlobal\n}\n\nexport class GlobalConsumer extends React.Component {\n    return() {\n        return <Consumer>{GlobalBus => children(GlobalBus)}</Consumer>\n    }\n}\n\nGlobalConsumer.propTypes = {\n    children: PropTypes.func.isRequired\n}\n\nexport class GlobalProvider extends React.Component {\n    constructor() {\n        super()\n        \n        let homepage = require(\"../../package.json\").homepage\n\n        this.data = {\n            basePath: homepage?(new URL(homepage)).pathname:\"\",\n        }\n    }\n\n    render() {\n        const { children } = this.props\n        return <Provider value={this.data}>{children}</Provider>\n    }\n}\n\nGlobalProvider.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.node, PropTypes.arrayOf(PropTypes.node)])\n}","import React from \"react\"\nimport { Flex, Icon, Text } from \"@chakra-ui/core\"\nimport { withRouter } from \"react-router-dom\"\nimport { withGlobal } from \"../utils/global\"\n\n// import CheckinApp from \"../apps/checkin\"\n// import Debugger from \"../apps/Debugger\"\n\n@withRouter\nclass AppPage extends React.Component {\n\n    constructor() {\n        super()\n    }\n\n    appCaches = {}\n\n    componentWillMount() {\n        let app\n        try { app = require(`../apps/${this.props.name}`).default } catch(e) {}\n        if (app) this.appCaches[this.props.name] = app\n\n        // 更新title等\n        window.document.title = this.props.title\n    }\n\n    render() {\n        let app = this.appCaches[this.props.name]\n        if (app) return React.createElement(app)\n        return <Text>应用错误: {this.props.name}</Text>\n    }\n}\n\n@withRouter\n@withGlobal\nclass AppPreview extends React.Component {\n\n    _onClick() {\n        this.props.history.push(`${this.props.globalData.basePath}/${this.props.name}`)\n    }\n\n    render() {\n        let { title, name, icon = \"time\" } = this.props\n        return <Flex\n        onClick={this._onClick.bind(this)}\n        cursor=\"pointer\"\n        border=\"1px\" borderRadius=\"md\" borderColor=\"gray.300\"\n        w=\"100%\" h=\"20\"\n        align=\"center\" justify=\"center\" direction=\"column\">\n            <Icon name={icon} />\n            <Text my={1}>{title}</Text>\n        </Flex>\n    }\n}\n\nexport { AppPreview }\n\nexport default AppPage","import React from \"react\"\nimport { inject } from \"mobx-react\"\n\nimport { Grid, Box } from \"@chakra-ui/core\"\n\nimport { AppPreview } from \"./app\"\n\n@inject(\"appStore\")\nclass HomePage extends React.Component {\n\n    componentWillMount() {\n        window.document.title = \"Vanish 小程序\"\n    }\n\n    // 显示app列表\n    render() {\n        return <Box p={2}>\n            <Grid templateColumns=\"repeat(3, 1fr)\" gap={6}>\n                {this.props.appStore.apps.map((app, idx) => <AppPreview key={idx} {...app} />)}\n            </Grid>\n        </Box>\n    }\n}\n\nexport default HomePage","import React from \"react\"\nimport { inject } from \"mobx-react\"\n\nimport { Flex, Button } from \"@chakra-ui/core\"\n\nclass NotFoundPage extends React.Component {\n\n    constructor() {\n        super()\n    }\n\n    _onClick() {\n        this.props.appStore.addCount()\n    }\n\n    render() {\n        return <Flex>\n            Chakra UI! 404\n        </Flex>\n    }\n}\n\nexport default NotFoundPage","import React from \"react\"\nimport { Switch, Route, BrowserRouter, withRouter } from \"react-router-dom\"\nimport { inject, observer } from \"mobx-react\"\n\nimport HomePage from \"./pages/home\"\nimport AppPage from \"./pages/app\"\nimport NotFoundPage from \"./pages/404\"\nimport { withGlobal } from \"./utils/global\"\n\n@withRouter\n@withGlobal\n@inject(\"appStore\")\n@observer\nexport default class App extends React.Component {\n\n    constructor() {\n        super()\n    }\n\n    componentDidMount() {\n        // load apps\n        this.props.appStore.loadApps()\n    }\n\n    render() {\n        let basePath = this.props.globalData.basePath\n        return <Switch>\n            <Route exact path={basePath||'/'} children={<HomePage />} />\n            {this.props.appStore.apps.map((app, idx) => <Route key={idx} path={`${basePath||''}/${app.name}`} children={<AppPage basePath={basePath} {...app} />} />)}\n            <Route component={NotFoundPage} />\n        </Switch>\n    }\n}","// app storage\nimport { observable, action, computed } from 'mobx'\n\nconst mockApps =  [\n    { name: 'checkin', icon: \"time\", title: \"打卡签到\" },\n    { name: 'debugger', icon: \"view\", title: \"JS调试\" },\n]\n\nexport class AppStore {\n    @observable isLoading = false\n    // we store app at here with id\n    @observable appsRegistry = observable.map()\n\n    @computed get apps() {\n        // FIXME:\n        return Array.from(this.appsRegistry.values())\n    }\n\n    @action loadApps() {\n        this.isLoading = true\n\n        this.appsRegistry.clear()\n\n        // loads apps from server\n        // store app at here or we need to extact some things like settings and routers?\n\n        // store in registry, if then need call action\n        mockApps.forEach(item => this.appsRegistry.set(item.name, {id: item.name, text: item.title, ...item}))\n\n        this.isLoading = false\n    }\n}\n\nexport default new AppStore()","import appStore from \"./appStore\"\n\nexport default {\n    appStore\n}","import { theme } from \"@chakra-ui/core\"\n\n// custom theme\nexport default {\n    ...theme,\n    colors: {\n        ...theme.colors,\n        brand: {\n            900: \"#1a365d\",\n            800: \"#153e75\",\n            700: \"#2a69ac\",\n        }\n    }\n}","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from \"react-router-dom\"\nimport { Provider } from \"mobx-react\"\nimport { ThemeProvider } from \"@chakra-ui/core\"\n\nimport * as serviceWorker from './utils/serviceWorker'\n\nimport App from \"./App\"\n\nimport stores from \"./stores\"\nimport { GlobalProvider } from './utils/global'\n\nimport \"./styles/core.css\"\nimport theme from \"./styles/theme\"\n\nReactDOM.render(<Provider {...stores}>\n    <ThemeProvider theme={theme}>\n        <GlobalProvider>\n            <BrowserRouter>\n                <App />\n            </BrowserRouter>\n        </GlobalProvider>\n    </ThemeProvider>\n</Provider>, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import React from \"react\"\n\nimport { Box, Grid, Flex, useToast, Button, Text } from \"@chakra-ui/core\"\nimport { TimePicker, DatePicker, TimePrecision } from \"@blueprintjs/datetime\"\n\nimport { LocaleUtils } from \"react-day-picker\"\nimport \"moment/locale/zh-cn\"\n\nclass CheckinApp extends React.Component {\n    constructor() {\n        super()\n        \n        // this.toaster = useToast()\n        let date = new Date()\n        // let user = jsVanish.getVanishUserInfo()\n        // let deviceid = jsVanish.getDeviceUUID()\n\n        this.state = {\n            date, // 日期\n            email: null,\n            name: null,\n            location: {\n                idx: 'W',\n                address: '同顺街18号--同花顺', // 新大楼\n                longitude: 120.046353,\n                latitude: 30.292516,\n            }, // 地点\n            checkinTime: date.getTime(), // 时间\n            checkoutTime: date.getTime(), // 时间\n        }\n    }\n\n    componentWillMount() {\n        if (window.jsVanish) {\n            try {\n                // 加载用户信息\n                let d = window.jsVanish.getVanishUserInfo()\n                let user = d?JSON.parse(d):null\n                this.setState({\n                    name: user.ClientName,\n                    email: user.ClientEmail,\n                    device_id: window.jsVanish.getDeviceUUID(),\n                })\n            } catch(e) {}\n        }\n\n        // 加载当天的信息\n        this.loadTodayInfo()\n    }\n\n    checkIn(type) {\n        let { date, email, name, device_id, location: { longitude, latitude, address, idx } } = this.state\n        if (!email) {\n            alert(\"未获取到用户信息\")\n            return\n        }\n        checkIn({\n            date, email, name, type,\n            longitude, latitude,\n            device_id,\n            clock_addr: address,\n            clock_addr_num: idx,\n        }).then((res) => {\n            console.log(res)\n        })\n    }\n\n    loadTodayInfo() {\n        let { email, name } = this.state\n        if (!email) {\n            alert(\"未获取到用户信息\")\n            return\n        }\n        // 查询记录\n        queryCheckIn({\n            email,\n            date: this.state.date.toISOString().split(\"T\")[0], // 字符串\n        }).then((res) => {\n            console.log(res)\n        })\n    }\n\n    onDateClick(date) {\n        this.setState({ date })\n    }\n\n    render() {\n        return <Grid templateRows=\"repeat(3, 1fr)\" gap={6}>\n            {/* 用户信息 */}\n            <Flex justify=\"center\">\n                <DatePicker onChange={this.onDateClick.bind(this)} localeUtils={LocaleUtils} locale=\"zh-cn\" value={this.state.date} />\n            </Flex>\n            <Flex justify=\"center\" align=\"center\">\n                <Text>{this.state.location.address}</Text>\n            </Flex>\n            {this.state.email?<Flex justify=\"space-between\" align=\"center\">\n                <CheckinItem label=\"上班\" onClick={this.checkIn.bind(this, 1)} />\n                <CheckinItem label=\"下班\" onClick={this.checkIn.bind(this, 2)} />\n            </Flex>:null}\n        </Grid>\n    }\n}\n\nexport default CheckinApp\n\n// 未打 \"\" 卡，立即 \"\" 打卡\n// 过去的时间\nconst CheckinItem = ({ label, disable, checkTime, onClick }) => {\n    let done = checkTime?true:false\n    return <Flex direction=\"column\">\n        {done?<TimePicker value={checkTime} precision={TimePrecision.SECOND} />\n        :<Text>未打卡</Text>}\n        <Button onClick={onClick}>{done?\"已\":\"立即\"}打卡{label}</Button>\n    </Flex>\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// ============================== //\n\nconst serialize = (obj, prefix) => {\n    let str = [], p;\n    for (p in obj) {\n      if (obj.hasOwnProperty(p)) {\n        let k = prefix ? prefix + \"[\" + p + \"]\" : p,\n          v = obj[p];\n        str.push((v !== null && typeof v === \"object\") ?\n          serialize(v, k) :\n          encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n      }\n    }\n    return str.join(\"&\")\n  }\n\nconst apiHost = [118,97,110,105,115,104,97,112,112,46,49,48,106,113,107,97,46,99,111,109,46,99,110].map(i=>String.fromCharCode(i)).join(\"\")\n\nconst request = (url, data, method=\"POST\") => {\n    return fetch(`//${apiHost}/check/backend/index/${url}`, {\n        method,\n        headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        body: serialize(data),\n    }).then(res=>res.json()).then(({ status, payload })=>{\n        return payload\n    })\n}\n\n// 查询记录\nconst queryCheckIn = ({email, date}) => {\n    return request(\"query\", {email, date})\n}\n\n// 打卡签到\nconst checkIn = (res) => {\n    return request(\"clock\", res)\n}\n\nconst PositionList = {\n    W: {\n      idx: 'W',\n      address: '新大楼',\n      longitude: 120.046353,\n      latitude: 30.292516\n    },\n    C: {\n      idx: 'C',\n      address: '产业园',\n      longitude: 120.125761,\n      latitude: 30.291462\n    },\n    SZ: {\n      idx: 'SZ',\n      address: '深圳',\n      longitude: 114.068731,\n      latitude: 22.532294\n    },\n    SH: {\n      idx: 'SH',\n      address: '上海',\n      longitude: 121.540262,\n      latitude: 31.233591\n    },\n    BJ: {\n      idx: 'BJ',\n      address: '北京',\n      longitude: 116.349700,\n      latitude: 39.939160\n    },\n    NJ: {\n      idx: 'NJ',\n      address: '南京',\n      longitude: 118.792199,\n      latitude: 32.036075\n    },\n    GZ: {\n      idx: 'GZ',\n      address: '广州',\n      longitude: 113.328924,\n      latitude: 23.136686\n    },\n    WH: {\n      idx: 'WH',\n      address: '武汉',\n      longitude: 114.273242,\n      latitude: 30.580598\n    }\n  }"],"sourceRoot":""}